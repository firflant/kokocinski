services:
  page_analytics.report_controller:
    class: Drupal\page_analytics\Controller\PageAnalyticsReportController
    arguments:
      - "@database"
      - "@datetime.time"

  # Before page cache (priority 210 > 200) so cache hits are counted too.
  http_middleware.page_analytics:
    class: Drupal\page_analytics\StackMiddleware\PageAnalyticsMiddleware
    arguments:
      - "@config.factory"
      - "@queue"
      - "@datetime.time"
      - "@current_user"
    tags:
      - { name: http_middleware, priority: 210 }
